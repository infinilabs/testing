path.data: data
path.logs: log

entry:
  - name: my_es_entry
    enabled: true
    router: my_router
    max_concurrency: 2000
    network:
      binding: 0.0.0.0:8000

flow:
  - name: test
    filter:
      - context_limiter:
          max_requests: 2
          action: drop
          context:
            - _ctx.request.path
            - _ctx.request.header.Host
            - _ctx.request.header.Env

router:
  - name: my_router
    default_flow: test

#  ab -n 5 -c 5 -H 'Env: dev' http://localhost:8000/user/_search
#  response: Server Software:
      #Server Hostname:        localhost
      #Server Port:            8000
      #
      #Document Path:          /user/_search
      #Document Length:        0 bytes
      #
      #Concurrency Level:      5
      #Time taken for tests:   0.002 seconds
      #Complete requests:      5
      #Failed requests:        3
      #   (Connect: 0, Receive: 0, Length: 3, Exceptions: 0)
      #Non-2xx responses:      5
      #Total transferred:      608 bytes
      #HTML transferred:       60 bytes
      #Requests per second:    2142.25 [#/sec] (mean)
      #Time per request:       2.334 [ms] (mean)
    #Time per request:       0.467 [ms] (mean, across all concurrent requests)
    #Transfer rate:          254.39 [Kbytes/sec] received