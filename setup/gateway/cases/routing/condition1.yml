path.data: data
path.logs: log

entry:
  - name: my_es_entry
    enabled: true
    router: my_router
    max_concurrency: 200000
    network:
      binding: 0.0.0.0:8000

flow:
  - name: hello_world
    filter:
      - set_request_query_args:
          args:
            - preference -> _prefer_nodes:data-db-es-230-60.xxxx.xxx.com
          when:
            and:
              - contains:
                  _ctx.request.path: /_search
              - not:
                  contains: #-排除一下带/scroll的请求，不加preference参数
                    _ctx.request.path: /scroll
      - dump:
          uri: true
      - echo:
          message: "hello world"
router:
  - name: my_router
    default_flow: hello_world

#curl localhost:8000/_search
#curl localhost:8000/_search/scroll
