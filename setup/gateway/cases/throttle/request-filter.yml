path.data: data
path.logs: log

entry:
  - name: test_entry
    enabled: true
    router: default
    max_concurrency: 20000
    network:
      binding: 0.0.0.0:8000

router:
  - name: default
    default_flow: test

flow:
  - name: test
    filter:
      - request_client_ip_filter:
          exclude:
            - 192.168.1.1
      - context_filter:
          context: _ctx.request.path
          message: "request not allowed."
          status: 403
#          include:
#            - /favicon.ico
#          must: #must match all rules to continue
#            prefix:
#              - /medcl
#            contain:
#              - _search
#            suffix:
#              - _count
#              - _refresh
#            wildcard:
#              - /*/_refresh
#            regex:
#              - ^/m[\w]+dcl
#          must_not: # any match will be filtered
#            prefix:
#              - /.kibana
#              - /_security
#              - /_security
#              - /gateway_requests*
#              - /.reporting
#              - /_monitoring/bulk
#            contain:
#              - _search
#            suffix:
#              - _count
#              - _refresh
#            wildcard:
#              - /*/_refresh
#            regex:
#              - ^/m[\w]+dcl
          should:
            prefix:
              - /medcl
            contain:
              - _search
              - _async_search
            suffix:
              - _refresh
            wildcard:
              - /*/_refresh
            regex:
              - ^/m[\w]+dcl
      - echo:
          message: Hello
  - name: request_filter
    filter:
      - context_filter:
          context: _ctx.request.path
          message: "request not allowed."
          status: 403
          include:
            - /favicon.ico
#          exclude:
#            - /favicon.ico
#          should:
#            prefix:
#              - /abc
#              - /efg
#          must:
#            prefix:
#              - /abc
#          must_not:
#            prefix:
#              - /favicon.ico
#            contain:
#              - .ico
#            suffix:
#              - .ico
#            wildcard:
#              - /fav**on.ico
      - echo:
          message: Hello
